<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATLAS; Automated Teacher-Learner Anchoring System</title>
    <link rel="stylesheet" href="/static/style.css" />
    <link rel="stylesheet" href="/static/btn_colors.css" />
    <link rel="stylesheet" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="../static/home.js"></script>
</head>

<body>
    <div class="wrap-loading display-none">
        <div>
            <video muted autoplay loop>
                  <source src="../static/loading.mp4" type="video/mp4">
             </video>
        </div>
    </div>

    <div class="head_container">
        ATLAS 인공지능이 키워드를 추출합니다.
    </div>
    <div class="head_container2">
        아래 좌측 박스에 원문을 삽입하세요.
    </div>

    <span class="guide">
        <div class="items_h_container" style="margin-top: 50px; ">
            <div class="leftitem" style="margin-right: 56px;">
                <textarea id="inputText" type="text" placeholder="300~1500자 입력" onkeyup="checkByte(this)">
                </textarea>
            </div>
            <div class='rightitem' style="margin-left: 60px;">
                <textarea id="resultWindow" type="text" placeholder="300~1500자 입력" onkeyup="checkByte(this)">
            </textarea>
            </div>
        </div>
    </span>

    <span class="guide2">
        <div class="btn_container">
            <span class="byte_container" style="margin-top: 370px; ">
                <span id="nowByte" style="color: green;padding-right: 3px;">
                </span>
                / 3000 bytes
            </span>
        </div>

        <div class="btn_container">
            <span class="byte_container" style="margin-top: 340px; ">
                <span id="nowByte" style="color: green;padding-right: 95px;">
                </span>
            </span>
        </div>
    </span>

    <span class="guide" style="margin-top: 378px; ">
        <div class="btn_container">
            <button class="btn_darkblue" onclick="btnClick()">
                <font size=6>키워드 추출</font>
            </button>
        </div>

        <div class="btn_container">
            <button class="btn_darkblue" onclick="btnClick()">
                <font size=6>평가문항 생성</font>
            </button>
        </div>
    </span>
    

    <script>
        function btnClick() {
            const inputText = $("#inputText").val();
            console.log(inputText)
            $.ajax({
                type: "POST",
                url: "/inputText",
                data: { data: inputText },
                success: function (toStr) {
                    console.log(toStr)
                    const quizWin = window.open('http://127.0.0.1:5000/quiz', '_blank');
                    $("#result_list").append(`${toStr} `)
                },
                beforeSend: function () {
                    $('.wrap-loading').removeClass('display-none');
                },
                complete: function () {
                    $('.wrap-loading').addClass('display-none');
                }
            })
        }

        function checkByte(obj) {
            const maxByte = 3000; //최대 3000바이트
            const text_val = obj.value; //입력한 문자
            const text_len = text_val.length; //입력한 문자수

            let totalByte = 0;
            for (let i = 0; i < text_len; i++) {
                const each_char = text_val.charAt(i);
                const uni_char = escape(each_char) //유니코드 형식으로 변환
                if (uni_char.length > 4) {
                    // 한글 : 2Byte
                    totalByte += 2;
                } else {
                    // 영문,숫자,특수문자 : 1Byte
                    totalByte += 1;
                }
            }

            if (totalByte > maxByte) {
                alert('최대 3000Byte(1500자)까지만 입력가능합니다.');
                document.getElementById("nowByte").innerText = totalByte;
                document.getElementById("nowByte").style.color = "red";
            } else {
                document.getElementById("nowByte").innerText = totalByte;
                document.getElementById("nowByte").style.color = "green";
            }
        }
    </script>

<img src="../static/small_logo_pivot.png" width="105px" height="127px" style="margin-left: 1815px; padding-top: 0px;">

</body>

</html>